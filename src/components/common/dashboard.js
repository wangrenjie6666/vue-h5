/* eslint-disable */
"use strict";function _possibleConstructorReturn(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i}function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}function _toConsumableArray(t){if(Array.isArray(t)){for(var i=0,e=Array(t.length);i<t.length;i++)e[i]=t[i];return e}return Array.from(t)}function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var _get=function t(i,e,s){null===i&&(i=Function.prototype);var n=Object.getOwnPropertyDescriptor(i,e);if(void 0===n){var a=Object.getPrototypeOf(i);return null===a?void 0:t(a,e,s)}if("value"in n)return n.value;var o=n.get;if(void 0!==o)return o.call(s)},_createClass=function(){function t(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(i,e,s){return e&&t(i.prototype,e),s&&t(i,s),i}}(),Dashboard=function(){function t(i){if(_classCallCheck(this,t),!i.canvas)throw new Error("missing canvas DOM");this.width=180,this.showValue=!0,this.maxValue=100,this.value=0,this.desc="",this.toFixed=0,this.unit="",this.count=96,this.degree=270,this.speed=1,this.textColor="#fff",this.valueFontSize=44,this.descFontSize=14,this.valueY=0,this.descY=50,this.index=0,this.linear=!1,this.oldValue=0,this.stop=!1,this.remRatio=document.documentElement.clientWidth>640?640/375:document.documentElement.clientWidth/375}return _createClass(t,[{key:"initCanvas",value:function(){var t=window.devicePixelRatio||1;this.rafId=0,this.canvas.style.width=this.width+"px",this.canvas.style.height=this.width+"px",this.canvas.width=this.width*t,this.canvas.height=this.width*t,this.ctx=this.canvas.getContext("2d"),this.ctx.scale(t,t)}},{key:"limitOption",value:function(t){t.value>(t.maxValue||this.maxValue)&&(t.value=t.maxValue||this.maxValue),t.degree>360&&(t.degree=360),t.degree<180&&(t.degree=180),t.index>(t.count||this.count)&&(t.index=t.count||this.count)}},{key:"mergeOption",value:function(t,i){var e=this,s="Array"===this.typeof(i);!i&&(i=[]);var n=[].concat(_toConsumableArray(i),["width","valueFontSize","descFontSize","valueY","descY"]);this.limitOption(t),Object.keys(t).forEach(function(i){if(""!==e[i]&&!isNaN(e[i])&&isNaN(t[i]))return void(t[i]=e[i]);var s=n.indexOf(i);-1!==s?(e[i]=Math.round(e.rem(t[i])),n.splice(s,1)):e[i]=t[i]}),s&&n.forEach(function(t){e[t]=Math.round(e.rem(e[t]))})}},{key:"setComputedDataHandler",value:function(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=new ComputedData,n=[{key:"value"},{key:"oldValue"},{key:"index"},{key:"degree"},{key:"width",watch:this.initCanvas},{key:"count",watch:function(){this.index>this.count&&(this.index=this.onTickCount)}}],a=[{key:"halfW",value:function(){return t.width/2}},{key:"onTickCount",value:function(){return Math.ceil(t.value/t.maxValue*t.count)}},{key:"oldOnTickCount",value:function(){return Math.ceil(t.oldValue/t.maxValue*t.count)}},{key:"maxRadian",value:function(){var t=this.degree*Math.PI/180;return this.singleRadian=t/this.count,this.rotateRadian=(2*Math.PI-t)/-2,t}},{key:"decrement",value:function(){return this.value,this.index>this.onTickCount||!(this.index<this.onTickCount)&&void 0}},{key:"currentValue",value:function(){var t=this.index;return void 0===this.decrement&&0===this.onTickCount?0:this.decrement?t/this.oldOnTickCount*this.oldValue:t/this.onTickCount*this.value}}];[].concat(n,_toConsumableArray(i)).forEach(function(i){return s.defineProperty(t,i.key,t[i.key],i.watch)}),[].concat(a,_toConsumableArray(e)).forEach(function(i){return s.defineComputed(t,i.key,i.value)})}},{key:"typeof",value:function(t){return Object.prototype.toString.call(t).split(" ")[1].slice(0,-1)}},{key:"drawText",value:function(t,i,e){this.ctx.save(),this.ctx.beginPath(),this.ctx.translate(this.halfW,this.halfW),this.ctx.textBaseline="middle",this.ctx.textAlian="center",this.ctx.font=i+"px arial",this.ctx.fillStyle=this.textColor,this.ctx.fillText(t,this.ctx.measureText(t).width/-2,e),this.ctx.restore()}},{key:"drawValue",value:function(){var t=this.currentValue.toFixed(this.toFixed)+this.unit;this.drawText(t,this.valueFontSize,this.valueY)}},{key:"drawDesc",value:function(){this.drawText(this.desc,this.descFontSize,this.descY)}},{key:"rem",value:function(t){return t*this.remRatio}},{key:"update",value:function(t){var i=this.typeof(t);"Object"===i?this.mergeOption(t):"String"!==i&&"Number"!==i||this.mergeOption({value:t}),this.animate()}},{key:"animate",value:function(){if(cancelAnimationFrame(this.rafId),this.linear||(this.speed=Math.abs((this.onTickCount-this.index)/30)>.1?Math.abs((this.onTickCount-this.index)/30):.1),this.index=!0===this.decrement?1*(this.index-this.speed).toFixed(1):!1===this.decrement?1*(this.index+this.speed).toFixed(1):this.index+0,this.decrement&&this.index<=this.onTickCount||!this.decrement&&this.index>=this.onTickCount)this.index=this.onTickCount,this.oldValue=this.value;else{if(this.stop)return void(this.stop=!1);this.rafId=requestAnimationFrame(this.animate.bind(this))}this.draw()}},{key:"toMax",value:function(){this.index=this.onTickCount}},{key:"stopNow",value:function(){this.stop=!0}}]),t}(),DotDashboard=function(t){function i(t){_classCallCheck(this,i);var e=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));return e.initOption(t),e.initCanvas(),e.animate(),e}return _inherits(i,t),_createClass(i,[{key:"initOption",value:function(t){this.showDot=!0,this.lineWidth=6,this.lineCap="round",this.lineColor="#fff",this.outerDotColor="#fff",this.innerDotColor="#0087d2",this.outerDotRadius=10,this.cover=!1,this.lineCoverColor="#0087d2",this.mergeOption(t,["lineWidth","outerDotRadius"]),this.setComputedDataHandler()}},{key:"setComputedDataHandler",value:function(){var t=this,e=[{key:"outerDotRadius"}],s=[{key:"innerDotRadius",value:function(){return.6*t.outerDotRadius}},{key:"radius",value:function(){var t=this.outerDotRadius,i=this.lineWidth/2,e=this.width/2;return t+1>i?e-t-1:e-i}}];_get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"setComputedDataHandler",this).call(this,e,s)}},{key:"draw",value:function(){this.ctx.clearRect(0,0,this.width,this.width),this.drawCircle(),this.cover&&this.drawCircle(this.singleRadian*this.index,this.lineCoverColor),this.showDot&&this.drawDot(),this.showValue&&this.drawValue(),this.desc&&this.drawDesc()}},{key:"drawCircle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.maxRadian,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.lineColor;this.ctx.save(),this.ctx.beginPath(),this.ctx.translate(this.halfW,this.halfW),this.ctx.rotate(-this.rotateRadian+Math.PI/2),this.ctx.strokeStyle=i,this.ctx.lineWidth=this.lineWidth,this.ctx.lineCap=this.lineCap,this.ctx.arc(0,0,this.radius,0,t),this.ctx.stroke(),this.ctx.restore()}},{key:"drawDot",value:function(){var t=this.maxRadian-this.singleRadian*this.index,i=Math.sin(t)*this.radius,e=Math.cos(t)*this.radius;this.ctx.save(),this.ctx.beginPath(),this.ctx.translate(this.halfW,this.halfW),this.ctx.rotate(this.rotateRadian),this.ctx.fillStyle=this.outerDotColor,this.ctx.strokeStyle=this.innerDotColor,this.ctx.arc(i,e,this.outerDotRadius,0,2*Math.PI),this.ctx.stroke(),this.ctx.fill(),this.ctx.beginPath(),this.ctx.fillStyle=this.innerDotColor,this.ctx.arc(i,e,this.innerDotRadius,0,2*Math.PI),this.ctx.fill(),this.ctx.restore()}}]),i}(Dashboard),TickDashboard=function(t){function i(t){_classCallCheck(this,i);var e=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));return e.initOption(t),e.initCanvas(),e.animate(),e}return _inherits(i,t),_createClass(i,[{key:"initOption",value:function(t){this.tickWidth=.8,this.tickHeight=2,this.underColor="#bbb",this.onColor="#fff",this.mergeOption(t,["tickHeight"]),this.setComputedDataHandler()}},{key:"drawTick",value:function(t,i){this.ctx.save(),this.ctx.beginPath(),this.ctx.translate(this.halfW,this.halfW),this.ctx.rotate(this.rotateRadian),this.ctx.strokeStyle=i,this.ctx.lineWidth=this.tickHeight;for(var e=0;e<=t;e++){var s=this.maxRadian-this.singleRadian*e,n=Math.sin(s)*this.halfW,a=Math.cos(s)*this.halfW,o=Math.sin(s)*this.halfW*this.tickWidth,h=Math.cos(s)*this.halfW*this.tickWidth;this.ctx.moveTo(o,h),this.ctx.lineTo(n,a)}this.ctx.stroke(),this.ctx.restore()}},{key:"draw",value:function(){this.ctx.clearRect(0,0,this.width,this.width),this.drawTick(this.count,this.underColor),this.drawTick(this.index,this.onColor),this.showValue&&this.drawValue(),this.desc&&this.drawDesc()}}]),i}(Dashboard),DotTickDashboard=function(t){function i(t){_classCallCheck(this,i);var e=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));return e.initOption(t),e.initCanvas(),e.animate(),e}return _inherits(i,t),_createClass(i,[{key:"initOption",value:function(t){this.tickWidth=.8,this.tickHeight=2,this.underColor="#a0d6ff",this.onColor="#008ffe",this.textColor="#008ffe",this.bigDotRadius=3,this.degree=360,this.descY=30,this.valueFontSize=36,this.descFontSize=12,this.mergeOption(t,["tickHeight","bigDotRadius"]),this.setComputedDataHandler()}},{key:"limitOption",value:function(t){_get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"limitOption",this).call(this,t),t.count/4%2&&(t.count=parseInt(t.count/4)%2&&4*(parseInt(t.count/4)+1)||4*parseInt(t.count/4))}},{key:"setComputedDataHandler",value:function(){var t=this,e=[{key:"bigDotRadius"}],s=[{key:"smallDotRadius",value:function(){return.4*t.bigDotRadius}},{key:"dotDis",value:function(){return t.width/2-t.bigDotRadius}},{key:"outerTickDis",value:function(){return t.width/2-2*t.bigDotRadius-t.rem(3)}},{key:"innerTickDis",value:function(){return(t.width/2-2*t.bigDotRadius-t.rem(3))*t.tickWidth}},{key:"innerCircleRadius",value:function(){return(t.width/2-2*t.bigDotRadius-t.rem(3))*t.tickWidth-t.rem(4)}}];_get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"setComputedDataHandler",this).call(this,e,s)}},{key:"drawTick",value:function(t,i){var e=this;this.ctx.save(),this.ctx.beginPath(),this.ctx.translate(this.halfW,this.halfW),this.ctx.rotate(this.rotateRadian),this.ctx.strokeStyle=i,this.ctx.fillStyle=i,this.ctx.lineWidth=this.tickHeight,this.for(t,function(t,i,s,n){var a=t*e.outerTickDis,o=i*e.outerTickDis,h=t*e.innerTickDis,r=i*e.innerTickDis;e.drawLine(a,o,h,r)}),this.ctx.stroke(),this.for(t,function(t,i,s,n){e.drawInnerCircle(e.innerCircleRadius,e.singleRadian*n)}),this.ctx.stroke(),this.ctx.beginPath(),this.for(t,function(t,i,s,n){var a=t*e.dotDis,o=i*e.dotDis;n%2||(n%(e.count/4)?e.ctx.arc(a,o,e.smallDotRadius,0,2*Math.PI):e.ctx.arc(a,o,e.bigDotRadius,0,2*Math.PI)),e.ctx.closePath()}),this.ctx.fill(),this.ctx.restore()}},{key:"for",value:function(t,i){for(var e=0;e<=t;e++){var s=this.maxRadian-this.singleRadian*e,n=Math.sin(s),a=Math.cos(s);"Function"===this.typeof(i)&&i(n,a,s,e)}}},{key:"drawLine",value:function(t,i,e,s){this.ctx.moveTo(t,i),this.ctx.lineTo(e,s)}},{key:"drawInnerCircle",value:function(t,i){this.ctx.beginPath(),this.ctx.save(),this.ctx.rotate(-this.rotateRadian+Math.PI/2-this.rotateRadian),this.ctx.arc(0,0,t,0,i),this.ctx.restore()}},{key:"draw",value:function(){this.ctx.clearRect(0,0,this.width,this.width),this.drawTick(this.count,this.underColor),this.drawTick(this.index,this.onColor),this.showValue&&this.drawValue(),this.desc&&this.drawDesc()}}]),i}(Dashboard),ComputedData=function(){function t(){_classCallCheck(this,t),this.dep=null}return _createClass(t,[{key:"defineProperty",value:function(t,i,e,s){var n=[],a=this;Object.defineProperty(t,i,{get:function(){return a.dep&&n.push(a.dep),e},set:function(i){e=i,n.forEach(function(t){return t()}),-1!==Object.prototype.toString.call(s).indexOf("Function")&&s.call(t)}})}},{key:"defineComputed",value:function(t,i,e){e=e.bind(t),this.dep=function(){s=e()};var s=e();this.dep=null,Object.defineProperty(t,i,{get:function(){return s}})}}]),t}();
export {
  DotDashboard,
  DotTickDashboard,
  TickDashboard
}